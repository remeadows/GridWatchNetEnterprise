# NetNynja Enterprise - NATS Production Configuration with JetStream
# This configuration enables authentication and TLS for production deployments

# Server identification
server_name: netnynja-nats

# Client connections
port: 4222

# HTTP monitoring
http_port: 8222

# Logging
debug: false
trace: false
logtime: true
log_file: "/data/nats.log"

# Maximum payload size (1MB)
max_payload: 1048576

# Maximum pending bytes per connection (64MB)
max_pending: 67108864

# Maximum connections
max_connections: 1000

# Ping interval and max outstanding pings
ping_interval: "2m"
ping_max: 2

# Write deadline
write_deadline: "10s"

# JetStream configuration
jetstream {
    store_dir: "/data/jetstream"

    # Maximum memory storage (256MB)
    max_memory_store: 268435456

    # Maximum file storage (10GB)
    max_file_store: 10737418240
}

# Authentication enabled for production
# Uses environment variable substitution - set NATS_PASSWORD in .env
authorization {
    users = [
        { user: "netnynja", password: "$NATS_PASSWORD" }
    ]
}

# TLS configuration for production
# Generate certificates with: ./infrastructure/scripts/generate-nats-certs.sh
# Store certificates in ./infrastructure/nats/certs/
tls {
    cert_file: "/certs/server.crt"
    key_file: "/certs/server.key"
    ca_file: "/certs/ca.crt"
    verify: true
    timeout: 2
}
